{
    "contents" : "---\ntitle: \"README\"\noutput:\n  html_document:\n    keep_md: yes\n---\n\n```{r,echo=FALSE}\nsuppressPackageStartupMessages(library(dplyr))\nsuppressPackageStartupMessages(library(ggplot2))\nsuppressPackageStartupMessages(library(magrittr))\nsuppressPackageStartupMessages(library(Quandl))\nsuppressPackageStartupMessages(library(lubridate))\nsuppressPackageStartupMessages(library(tseries))\nsuppressPackageStartupMessages(library(lmtest))\nQuandl.auth(\"uipvA4VQdjDviQ9TT3cE\")\n```\n\n```{r,echo=FALSE,cache=TRUE} \n# Data cleaning and set up\ninflation <- read.csv(\"inflation.csv\") %>% tbl_df() %>% rename(Infl = Inflation)\ninflation$Date <- dmy(inflation$Date)\ninflation %<>% mutate(year=year(Date)) %>% select(Infl,year)\n\nFed.Fund <- Quandl(\"FRED/DFF\") %>% tbl_df() %>% mutate(Date = ymd(Date), year=year(Date)) %>% rename(rate=Value)\nOne.Year <- Quandl(\"FRED/DTB1YR\") %>% tbl_df() %>% mutate(Date = ymd(Date), year=year(Date)) %>% rename(rate=Value)\nThree.Year <- Quandl(\"FRED/DGS3\") %>% tbl_df() %>% mutate(Date = ymd(Date), year=year(Date)) %>% rename(rate=Value)\nFive.Year <- Quandl(\"FRED/DGS5\") %>% tbl_df() %>% mutate(Date = ymd(Date), year=year(Date)) %>% rename(rate=Value)\nTen.Year <- Quandl(\"FRED/DGS10\") %>% tbl_df() %>% mutate(Date = ymd(Date), year=year(Date)) %>% rename(rate=Value)\nThirty.Year <- Quandl(\"FRED/DGS30\") %>% tbl_df() %>% mutate(Date = ymd(Date), year=year(Date)) %>% rename(rate=Value)\nStock <- read.csv(\"SP 500 PE Ratios.csv\") %>% tbl_df()\nStock$Date <- dmy(Stock$Date)\n\n# need a function to fix lubridates' issue with years before 1969 (assumes <69 means 2069 not 1969)\nfoo <- function(x){\n  m <- year(x) %% 100\n  year(x) <- ifelse(m > 15, 1900+m, 2000+m)\n  x\n}\n\nStock$Date <- foo(Stock$Date)\nStock %<>% arrange(Date) %>% mutate(PE = (1/PE)*100) %>% rename(stock.rate=PE) %>% mutate(year=year(Date))\n\nStock.Y <- Stock %>% group_by(year) %>% summarise(rate=mean(stock.rate)) %>% filter(year>1961 & year<2015) %>%\n  mutate(type=\"S&P 500\")\nFed.Fund.Y <- Fed.Fund %>% group_by(year = year(Date)) %>% summarise(rate=mean(rate)) %>% mutate(dur=\"Fed Funds\")\nOne.Year.Y <- One.Year %>% group_by(year = year(Date)) %>% summarise(rate=mean(rate)) %>% mutate(dur=\"One Year\")\nThree.Year.Y <- Three.Year %>% group_by(year = year(Date)) %>% summarise(rate=mean(rate)) %>% mutate(dur=\"Three Year\")\nFive.Year.Y <- Five.Year %>% group_by(year = year(Date)) %>% summarise(rate=mean(rate)) %>% mutate(dur=\"Five Year\")\nTen.Year.Y <- Ten.Year %>% group_by(year = year(Date)) %>% summarise(rate=mean(rate)) %>% mutate(dur=\"Ten Year\")\nThirty.Year.Y <- Thirty.Year %>% group_by(year = year(Date)) %>% summarise(rate=mean(rate)) %>% mutate(dur=\"Thirty Year\")\n\nspread <- bind_rows(Fed.Fund.Y,One.Year.Y) %>% bind_rows(Three.Year.Y) %>% bind_rows(Five.Year.Y) %>% \n  bind_rows(Ten.Year.Y) %>% bind_rows(Thirty.Year.Y) %>% mutate(year=as.character(year))\n\nall.years <- spread %>% group_by(dur) %>% summarise(rate=mean(rate)) %>% mutate(year=\"all\")\n\nspread.select <- spread %>% filter(year==2015 | year==1981 | year==1984) %>% bind_rows(all.years)\nspread.select$dur2 <- factor(spread.select$dur, levels=c(\"Fed Funds\",\"One Year\",\"Three Year\",\"Five Year\",\"Ten Year\",\"Thirty Year\"))\n\nReg.Data2 <- Three.Year.Y %>% select(year,bond.nom.rate = rate) %>% mutate(lag.year=year-1) %>%\n  inner_join(rename(inflation,lag.Infl=Infl),by=c(\"lag.year\"=\"year\")) %>% \n  inner_join(select(Stock.Y,year,stock.nom.rate = rate),by=\"year\")\n\nReg.Data2 %<>% mutate(bond.exp.rate=bond.nom.rate-lag.Infl,stock.exp.rate=stock.nom.rate-lag.Infl)\n\nGraph.Data2 <- select(Reg.Data2,year,rate=stock.nom.rate) %>% mutate(type=\"Nom.Stock\")\nGraph.Data2 <- select(Reg.Data2,year,rate=bond.nom.rate) %>% mutate(type=\"Nom.Bond\") %>% bind_rows(Graph.Data2)\nGraph.Data2 <- select(Reg.Data2,year,rate=bond.exp.rate) %>% mutate(type=\"Exp.Bond\") %>% bind_rows(Graph.Data2)\nGraph.Data2 <- select(Reg.Data2,year,rate=stock.exp.rate) %>% mutate(type=\"Exp.Stock\") %>% bind_rows(Graph.Data2)\nGraph.Data2$type <- as.factor(Graph.Data2$type)\n\nReg.Data.Dif2 <- Reg.Data2 %>% \n  select(-lag.Infl,-lag.year) %>% \n  mutate(bond.n.dif=bond.nom.rate-lag(bond.nom.rate),bond.e.dif=bond.exp.rate-lag(bond.exp.rate),\n         stock.n.dif=stock.nom.rate-lag(stock.nom.rate),stock.e.dif=stock.exp.rate-lag(stock.exp.rate)) %>% \n  select(year,bond.n.dif,bond.e.dif,stock.n.dif,stock.e.dif) %>% slice(2:length(year))\n```\n\n```{r,echo=FALSE}\nfilter(Graph.Data2,type!=\"Exp.Stock\") %>% \n  ggplot(aes(x=year,y=rate)) + geom_point(aes(col=type)) + geom_line(aes(col=type)) +\n  scale_color_manual(values=c(\"blue\", \"red\", \"limegreen\"),name=\"\",breaks=c(\"Nom.Bond\",\"Exp.Bond\",\"Nom.Stock\"),\n                     labels=c(\"Nominal 3YR Rate\",\"Exp. Real 3YR Rate\",\"Nominal S&P 500 Yield\")) +\n  xlab(\"Time\") + ylab(\"Rate of Return (%)\") + ggtitle(\"3YR US Treasury Bond vs S&P 500 Yields\")\n\nfilter(Graph.Data2,type!=\"Nom.Stock\") %>% \n  ggplot(aes(x=year,y=rate)) + geom_point(aes(col=type)) + geom_line(aes(col=type)) +\n  scale_color_manual(values=c(\"blue\", \"limegreen\", \"red\"),name=\"\",breaks=c(\"Nom.Bond\",\"Exp.Bond\",\"Exp.Stock\"),\n                     labels=c(\"Nominal 3YR Rate\",\"Exp. Real 3YR Rate\",\"Exp. Real S&P 500 Yield\")) +\n  xlab(\"Time\") + ylab(\"Rate of Return (%)\") + ggtitle(\"3YR US Treasury Bond vs S&P 500 Yields\")\n```",
    "created" : 1431046547017.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3640428840",
    "id" : "2F8768F2",
    "lastKnownWriteTime" : 1431044783,
    "path" : "C:/Users/Dean Young/Desktop/Math 241/Term Project/Term_Project_Github/Math-241-Term-Project/README.rmd",
    "project_path" : "README.rmd",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}